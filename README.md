# Flask åœ–ç‰‡è™•ç† API

é€™æ˜¯ä¸€å€‹ Flask æ‡‰ç”¨ç¨‹å¼ï¼Œä½œç‚ºå‰ç«¯èˆ‡ AI å¾Œç«¯ä¹‹é–“çš„ä¸­é–“å±¤ï¼Œç”¨æ–¼è™•ç†åœ–ç‰‡å»èƒŒåŠŸèƒ½ã€‚

## ğŸ“‹ åŠŸèƒ½æè¿°

- æ¥æ”¶å‰ç«¯ä¸Šå‚³çš„ Base64 æ ¼å¼åœ–ç‰‡
- è§£ç¢¼ä¸¦è½‰æ›åœ–ç‰‡æ ¼å¼
- è½‰ç™¼çµ¦ AI å¾Œç«¯é€²è¡Œå»èƒŒè™•ç†
- å›å‚³è™•ç†å¾Œçš„çµæœçµ¦å‰ç«¯

## ğŸ› ï¸ æŠ€è¡“æ£§

- **Python 3.9**
- **Flask** - Web æ¡†æ¶
- **Flask-CORS** - è™•ç†è·¨åŸŸè«‹æ±‚
- **Requests** - HTTP å®¢æˆ¶ç«¯
- **Docker** - å®¹å™¨åŒ–éƒ¨ç½²

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
test_project/
â”œâ”€â”€ app.py              # Flask ä¸»æ‡‰ç”¨ç¨‹å¼
â”œâ”€â”€ dockerfile          # Docker æ˜ åƒæª”é…ç½®
â”œâ”€â”€ requirements.txt    # Python ä¾è³´å¥—ä»¶
â”œâ”€â”€ run.sh             # å¿«é€Ÿéƒ¨ç½²è…³æœ¬
â””â”€â”€ README.md          # å°ˆæ¡ˆèªªæ˜æ–‡ä»¶
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Dockerï¼ˆæ¨è–¦ï¼‰

1. **ç¢ºä¿å·²å®‰è£ Docker**
   ```bash
   docker --version
   ```

2. **åŸ·è¡Œéƒ¨ç½²è…³æœ¬**
   ```bash
   chmod +x run.sh
   ./run.sh
   ```

3. **æ‡‰ç”¨å°‡é‹è¡Œåœ¨**
   ```
   http://192.168.233.128:5000
   ```

### æ–¹æ³•äºŒï¼šæœ¬åœ°é–‹ç™¼

1. **å®‰è£ä¾è³´**
   ```bash
   pip install -r requirements.txt
   ```

2. **é‹è¡Œæ‡‰ç”¨**
   ```bash
   python app.py
   ```

## ğŸ“¡ API ç«¯é»

### POST `/api/upload-image`

æ¥æ”¶å‰ç«¯ä¸Šå‚³çš„åœ–ç‰‡ä¸¦è½‰ç™¼çµ¦ AI å¾Œç«¯è™•ç†ã€‚

**è«‹æ±‚æ ¼å¼ï¼š**
```json
{
  "image_data": "base64ç·¨ç¢¼çš„åœ–ç‰‡è³‡æ–™",
  "filename": "photo.png"
}
```

**æˆåŠŸå›æ‡‰ï¼š**
```json
{
  "message": "å»èƒŒæˆåŠŸ",
  "processed_url": "http://ä½ çš„IP:5000/download/processed_photo.png",
  "original_filename": "photo.png"
}
```

**éŒ¯èª¤å›æ‡‰ï¼š**
```json
{
  "error": "éŒ¯èª¤è¨Šæ¯"
}
```

## âš™ï¸ é…ç½®èªªæ˜

åœ¨ `app.py` ä¸­ä¿®æ”¹ AI å¾Œç«¯åœ°å€ï¼š

```python
AI_BACKEND_URL = "http://192.168.233.128:8001/api/remove_bg"
```

æ ¹æ“šä½ çš„ Docker ç¶²è·¯é…ç½®æˆ– AI æœå‹™åœ°å€é€²è¡Œèª¿æ•´ã€‚

## ğŸ³ Docker æŒ‡ä»¤

```bash
# æ§‹å»ºæ˜ åƒæª”
docker build -t test-flask-app .

# é‹è¡Œå®¹å™¨
docker run -d --name flask-container -p 5000:5000 test-flask-app

# æŸ¥çœ‹å®¹å™¨æ—¥èªŒ
docker logs -f flask-container

# åœæ­¢å®¹å™¨
docker stop flask-container

# åˆªé™¤å®¹å™¨
docker rm flask-container
```

## ğŸ“ æ³¨æ„äº‹é …

1. **ç¶²è·¯é…ç½®**ï¼šç¢ºä¿å‰ç«¯ã€æ­¤ä¸­é–“å±¤ã€AI å¾Œç«¯ä¸‰è€…ä¹‹é–“ç¶²è·¯äº’é€š
2. **CORS è¨­å®š**ï¼šå·²å•Ÿç”¨ CORSï¼Œå…è¨±è·¨åŸŸè«‹æ±‚
3. **ç«¯å£é…ç½®**ï¼šé è¨­ä½¿ç”¨ 5000 ç«¯å£ï¼Œå¯åœ¨ `run.sh` ä¸­ä¿®æ”¹
4. **AI å¾Œç«¯**ï¼šéœ€è¦å…ˆå•Ÿå‹• AI å»èƒŒæœå‹™

## ğŸ”§ å¸¸è¦‹å•é¡Œ

**Q: ç„¡æ³•é€£ç·šåˆ° AI ä¼ºæœå™¨ï¼Ÿ**  
A: æª¢æŸ¥ `AI_BACKEND_URL` æ˜¯å¦æ­£ç¢ºï¼Œç¢ºèª AI æœå‹™å·²å•Ÿå‹•ä¸”ç¶²è·¯å¯é”ã€‚

**Q: Docker å®¹å™¨å•Ÿå‹•å¤±æ•—ï¼Ÿ**  
A: æª¢æŸ¥ 5000 ç«¯å£æ˜¯å¦è¢«ä½”ç”¨ï¼Œä½¿ç”¨ `docker logs flask-container` æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒã€‚

**Q: åœ–ç‰‡è™•ç†å¤±æ•—ï¼Ÿ**  
A: ç¢ºèªä¸Šå‚³çš„ Base64 æ ¼å¼æ­£ç¢ºï¼Œæª¢æŸ¥ AI å¾Œç«¯æ˜¯å¦æ­£å¸¸é‹ä½œã€‚

## ğŸ“„ æˆæ¬Š

æœ¬å°ˆæ¡ˆåƒ…ä¾›å­¸ç¿’å’Œé–‹ç™¼ä½¿ç”¨ã€‚
